-- Valid DAML Template: Simple IOU
-- This template should pass all safety checks

module Main where

template SimpleIOU
  with
    issuer: Party
    owner: Party
    amount: Decimal
    currency: Text
  where
    signatory issuer
    observer owner
    
    choice Transfer : ContractId SimpleIOU
      with
        newOwner: Party
      controller owner
      do
        create this with owner = newOwner
    
    choice Split : (ContractId SimpleIOU, ContractId SimpleIOU)
      with
        splitAmount: Decimal
      controller owner
      do
        assert (splitAmount > 0.0 && splitAmount < amount)
        iou1 <- create this with amount = splitAmount
        iou2 <- create this with amount = amount - splitAmount
        return (iou1, iou2)

